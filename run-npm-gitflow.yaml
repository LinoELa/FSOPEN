# üß∞ Scripts comunes para React + TypeScript + Redux + Toolkit

# FULL STACK OPEN

fsopen git_flow:
  fsopen:
    rename_root:
      description: Renombrar fsopen a fsopen/root (si existe la rama fsopen)
      commands:
        - git checkout fsopen || true
        - git branch -m fsopen/root
        - git push origin :fsopen || true
        - git push -u origin fsopen/root

    create_part:
      description: Crear nueva rama de trabajo (fsopen/part-${PART}) desde fsopen/root
      commands:
        - git checkout -b fsopen/part-${PART} fsopen/root
        - git push -u origin fsopen/part-${PART}

    list_branches:
      description: Listar ramas y limpiar referencias remotas
      commands:
        - git fetch --all --prune
        - git branch -a
        - git log --oneline --graph --decorate --all

    delete_part:
      description: Borrar rama local/remota fsopen/part-${PART}
      commands:
        - git branch -D fsopen/part-${PART}
        - git push origin :fsopen/part-${PART}

    restore_stash:
      description: Recuperar √∫ltimo stash
      commands:
        - git stash list
        - git stash show -p
        - git stash pop

    merge_main_into_root:
      description: Traer cambios de main ‚Üí fsopen/root
      commands:
        - git checkout main
        - git pull --ff-only origin main
        - git checkout fsopen/root
        - git pull --ff-only origin fsopen/root
        - git merge main
        - git push origin fsopen/root

    merge_part_into_root:
      description: Fusionar fsopen/part-${PART} ‚Üí fsopen/root
      commands:
        - git checkout fsopen/root
        - git pull --ff-only origin fsopen/root
        - git merge fsopen/part-${PART}
        - git push origin fsopen/root

    publish_current_branch:
      description: Publicar la rama actual y establecer upstream
      commands:
        - git push -u origin HEAD

    sync_without_merge:
      description: Sincronizar referencias sin mezclar (solo fetch/prune)
      commands:
        - git fetch --all --prune

    preview_diff_main_vs_root:
      description: Ver qu√© entrar√≠a de main en fsopen/root (previa al merge)
      commands:
        - git log --oneline --graph --decorate fsopen/root..main

    fix_detached_to_root:
      description: Salir de detached HEAD y volver a fsopen/root
      commands:
        - git switch fsopen/root

    silence_status_hints:
      description: Silenciar avisos tipo ‚Äúusa git push‚Ä¶‚Äù
      commands:
        - git config --global advice.statusHints false

    unset_upstream_current:
      description: Quitar el tracking de la rama actual (oculta ‚Äúadelantada por X‚Äù)
      commands:
        - git branch --unset-upstream

# Los comandos se ejecutan con:
# npm run <comando>

# NPM REACT
npm scripts:
  # üèÅ --- Desarrollo ---
  dev: vite # Inicia el servidor de desarrollo
  start: vite # Alias de dev (compatible con CRA/Vite)
  preview: vite preview # Previsualiza la build localmente

  # üèóÔ∏è --- Build / Producci√≥n ---
  build: vite build # Compila la aplicaci√≥n para producci√≥n
  serve: vite preview # Sirve la build en modo local
  clean: rimraf dist # Limpia la carpeta dist (requiere rimraf)

  # üß™ --- Testing ---
  test: vitest # Ejecuta los tests con Vitest
  test:watch: vitest --watch # Ejecuta tests en modo vigilancia
  test:coverage: vitest run --coverage # Genera reporte de cobertura
  test:e2e: playwright test # Tests de extremo a extremo (si usas Playwright)

  # üßπ --- Linting / Formateo ---
  lint: eslint . --ext .ts,.tsx # Analiza c√≥digo con ESLint
  lint:fix: eslint . --fix # Corrige errores autom√°ticamente
  format: prettier --write . # Formatea c√≥digo con Prettier
  typecheck: tsc --noEmit # Verifica tipos de TypeScript sin compilar

  # üß© --- Redux / Configuraci√≥n ---
  redux:generate-slice: plop # (opcional) Genera un slice de Redux autom√°ticamente
  redux:check-store: node scripts/checkStore.js # (custom) Validaci√≥n de store global

  # üì¶ --- Dependencias ---
  deps:audit: npm audit # Escanea vulnerabilidades
  deps:update: npm-check -u # Actualiza dependencias de forma interactiva
  deps:outdated: npm outdated # Muestra dependencias obsoletas

  # üß± --- Documentaci√≥n / Configuraci√≥n ---
  docs: typedoc --out docs src # Genera documentaci√≥n con TypeDoc
  analyze: source-map-explorer dist/*.js # Analiza tama√±o del bundle
  env: node -p "process.env" # Muestra variables de entorno activas

  # üöÄ --- Deploy / Producci√≥n ---
  deploy: gh-pages -d dist # Despliega en GitHub Pages
  vercel: vercel --prod # Despliega en Vercel
  netlify: netlify deploy --prod # Despliega en Netlify

  # üß† --- Mantenimiento ---
  check: npm run lint && npm run typecheck && npm test
  prepare: husky install # Inicializa hooks de Git (Husky)
